#!/usr/bin/python3
import os


def clear_screen():
    # clears the terminal screen for better formatting
    os.system('cls' if os.name == 'nt' else 'clear')


def show_welcome_message():
    print(r"""
   _____                        _    _____                  _   
  / ____|                      | |  / ____|                | |  
 | |    _   _ _ __ ___  ___  __| | | |     _ __ _   _ _ __ | |_ 
 | |   | | | | '__/ __|/ _ \/ _` | | |    | '__| | | | '_ \| __|
 | |___| |_| | |  \__ \  __/ (_| | | |____| |  | |_| | |_) | |_ 
  \_____\__,_|_|  |___/\___|\__,_|  \_____|_|   \__, | .__/ \__|
                                                 __/ | |        
                                                |___/|_|        
    """)
    print("\nDare you enter the Cursed Tomb?")


def pharaoh():
    print(r"""
                   ## #  ###  ##                
              ###### #########              
         ########### #############          
       # ############################       
     ## ###############################     
     ################# ################     
     ############ ## ## ###############     
      # #####  ## ## ##   #   #########     
     ####     ##  ## ## ##   ###  #####     
     ##       #### # # #####   #  # ##      
         ###### ## ### #########     #      
       ###### #####################  #      
      ## ############################       
       ####### #         ############       
       ## #                   ######        
       ##               #       #####       
       #      ##############      #         
       #  ##   ##   #   # #  ##  ##         
         #                     # #          
           #######    ########   #          
        # ###   #########    ## ###         
        ### #####   # # ##### ## #          
      ###  #######  # #######     ##        
        #           #            #          
                    #  ##      ##           
         ##### ##  ###  #########           
         # ##### ####### ###### ##          
           ###             ####             
              ##############                
              #  ######  #### #             
                          #  #              
             ##       #   ###               
               #############                
               ############                 
             # ############                 
                ###########                 
             #  ########### #               
            #   ############ ####           
       #   #  ## ############### ##         
      ###  ##### ############### ## #       
     ## ###  #   ########      # ####       
     #### # ###         #  ##### #  #       
     ######   ###### ######### ######       
     ######### #########  ###### ## #       
     # #### ########## ########## ###       
     ### ################# ### # ####       
       ###### ##############  # #           
                            #####           
    """)


def ankh():
    print(r"""
                                      
           @@@@@@@@@@@@           
         @@@@@@@@@@@@@@@@         
       @@@@@@        @@@@@@       
      @@@@@            @@@@       
      @@@@              @@@@      
      @@@                @@@      
      @@@@              @@@@      
      @@@@              @@@@      
       @@@@            @@@@       
       @@@@           @@@@@       
        @@@@@        @@@@@        
         @@@@@      @@@@@         
          @@@@@@  @@@@@@          
            @@@@@@@@@@            
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
               @@@@               
              @@@@@               
              @@@@@@              
              @@@@@@              
                                  
    
    """)


def canopic_jar():
    print(r"""

                         #########                         
                         ###    ##                         
                    ########   ########                    
                  ####    ##   ##    ####                  
                  ##       #   #       ##                  
                  ##  ###############  ##                  
                 ###  ##           ##  ###                 
                 ###  ######   ######  ###                 
                 ###   ##         ##   ###                 
                 ##    ##         ##    ##                 
                 ##    ###       ###    ##                 
                ###    #############    ###                
                ###    ##   ###   ##    ###                
                ##     #     #     #     ##                
                ###########################                
                ###########################                
                ###                     ###                
                ###                     ###                
                ###                     ###                
                 ##                     ##                 
                 ###                   ###                 
                 ###                   ###                 
                 ###                   ###                 
                  ##                   ##                  
                  ###                 ###                  
                  ###                 ###                  
                  ###   ###           ###                  
                   ##                 ##                   
                   ##       ###       ##                   
                   ###               ###                   
                   ###               ###                   
                    ###################                          


    """)


def mummy():
    print(r"""
    
                                                          
                     ++++++-                          
               ---+++---+++++-+                       
             ---+++#++----+++++++                     
             -+++++++++++-##+++++                     
            -+++++++#++++-+++++++                     
           +--++#++##++##++####+++                    
         ---+-++-++####++++#####+-                    
        -+-++-+++#+#####+++##+++++                    
      ++++++ --++++#########++++#+-                   
     +++++-- --+ ++#######+++++++++++                 
    -++++---  -++++++##++###+##++++++                 
    ++++ --.   +-+--+#######++  -+++++                
   -+++- ---    +++--++##++++- ---+++++               
   ++++-         ++++-+##+---+--+---+++-              
  ---++          ++-+#+--------- -- +++++ ++-++       
  ++----         --++++ +++-+--++-++-++++ ----+       
 -+++++-         -++++++-+---+++---++++++-++---       
 +++++++        .-+++-+ -++--++----++++++ ----+       
   --+      ------++++++-++-+++-----+#+++ +---++      
         -------+++++++++++++++-----+++++ +-----      
        ++---------+++##+++--+-------+++++------      
       +++++++-+-+-+##+++++++++-------++++------      
       ++++------+++#++++++++++-------++++------      
       +++--------++#++++++++++-------++++-----+      
       +++---------+#++#++++++++------+++-+----+      
      ++++---------+++##++++++++------++##+-----      
     +###+++-------+####++++++++------++###-----      
    +++-++++++++---+#+##++++++++-----+++###+++---+    
    ++++++++##++++++#####+++#++------++####++----++   
    ++++++++++++++++#++++++++++--++++++++##+++++++++  
     +++++++++++++++++++  +++#++-#+++++   +++++++++   
     ++++++++++++++++++++ +-+++++####-....+++++++++   
            ++++  +-+++++-+++--+--------.             
                         +--+-+------                 
                                                                                  
                                                                                                                                                                                                 
    """)


def showInstructions():
    # print a main menu and the commands
    # added name of directions so user knows what to input
    print(
        """
+--------------------------------+
|            Commands            |
|--------------------------------+
|  go [north, south, east, west] |
|  grab [item]                   |
+--------------------------------+

"""
    )


# display combat commands for user
def showCombatCommands():
    print(
        """
+--------------------------------+
|            Commands            |
|--------------------------------|
|  attack [punch, kick, slash]   |
|  run                           |
+--------------------------------+

"""
    )


# included a breakdown of the objective for the user
def showQuestDetails():
    print("""
Quest Details
=============
1. Your objective is to escape the tomb by finding the Ankh and the Canopic Jar.
2. The Ankh is guarded by an undead mummy. You must defeat it to obtain the Ankh.
3. Once you have both the Ankh and the Canopic Jar, head to the Entrance Hall to unlock the door and escape.

Good luck, brave explorer!
""")


def showStatus(game):
    # print the player's current status
    print("You are in the " + game['currentRoom'])
    # print the current inventory
    print("Inventory : " + str(game['inventory']))
    # print an item if there is one
    if "item" in game['rooms'][game['currentRoom']] and not game['in_combat']:
        print("You see a " + game['rooms'][game['currentRoom']]["item"])


def initialize_game():
    return {
        "inventory": [],
        "currentRoom": "Antechamber",
        "mummy_health": 50,
        "in_combat": False,
        "rooms": {
            "Antechamber": {"south": "Burial Chamber", "east": "Embalming Chamber"},
            "Burial Chamber": {
                "north": "Antechamber",
                "item": "mummy",
            },
            "Embalming Chamber": {
                "west": "Antechamber",
                "south": "Entrance Hall",
                "item": "canopic jar",
            },
            "Entrance Hall": {"north": "Embalming Chamber"},
        },
        "attacks": {
            "punch": {
                "damage": 10,
                "message": "You land a solid punch on the mummy!"},
            "kick": {
                "damage": 15,
                "message": "You deliver a powerful kick, scattering bandages!"},
            "slash": {
                "damage": 20,
                "message": "You unravel some of the mummy's bandages!"},
        }
    }


def main():
    game = initialize_game()

    clear_screen()
    show_welcome_message()
    showQuestDetails()
    input("Press Enter to start your adventure in the Cursed Tomb...")

    while True:
        clear_screen()

        # Check for mummy encounter or ongoing combat
        if not game['in_combat'] and "item" in game['rooms'][game['currentRoom']] and \
                game['rooms'][game['currentRoom']]["item"] == "mummy":
            game['in_combat'] = True
            mummy()
            print("An undead mummy has awakened and attacked you! You must defeat it to continue!")
            input("Press Enter to continue...")
            clear_screen()

        if game['in_combat']:
            showCombatCommands()
            print("An undead mummy is attacking you! You must defeat it to continue!")
        else:
            showInstructions()
            showStatus(game)

        # get the player's next 'move'
        move = input("> ").lower().split(" ", 1)

        # Handle invalid commands during combat
        if game['in_combat'] and (move[0] not in ["attack", "run"] or (move[0] == "attack" and len(move) < 2)):
            print("Invalid command. Please use one of the commands listed above.")
            input("Press Enter to continue...")
            continue

        # check if there's a mummy and the player tries to move or get an item
        if "item" in game['rooms'][game['currentRoom']] and game['rooms'][game['currentRoom']]["item"] == "mummy" and \
                move[0] in ["go", "grab"]:
            print("You cannot do that while the mummy is attacking! You must 'attack' or 'run'.")
            input("Press Enter to continue...")
            continue

        # handle cases where user provides incomplete commands
        if len(move) < 2 and move[0] not in ["attack", "run"]:
            print("Invalid command. Please use one of the commands listed above.")
            input("Press Enter to continue...")
            continue

        # if they type 'go' first
        if move[0] == "go":
            # check that they are allowed wherever they want to go
            if move[1] in game['rooms'][game['currentRoom']]:
                # set the current room to the new room
                game['currentRoom'] = game['rooms'][game['currentRoom']][move[1]]
                clear_screen()
            # there is no door (link) to the new room
            else:
                print(f"You can't go {move[1]} from here.")
                input("Press Enter to continue...")

        # if they type 'grab' first
        elif move[0] == "grab":
            # if the room contains an item, and the item is the one they want to get
            if "item" in game['rooms'][game['currentRoom']] and move[1] in game['rooms'][game['currentRoom']]["item"]:
                clear_screen()
                # add the item to their inventory
                game['inventory'].append(move[1])
                # display a helpful message
                canopic_jar()
                print(f"You've acquired the canopic jar!")
                input("Press Enter to continue...")
                # delete the item from the room
                del game['rooms'][game['currentRoom']]["item"]
            # otherwise, if the item isn't there to get
            else:
                # tell them they can't get it
                print(f"Can't grab {move[1]}!")
                input("Press Enter to continue...")

        # handle attacks
        elif move[0] == "attack":
            if "item" in game['rooms'][game['currentRoom']] and game['rooms'][game['currentRoom']]["item"] == "mummy":
                attack_type = move[1] if len(move) > 1 else "punch"
                if attack_type in game['attacks']:
                    game['mummy_health'] -= game['attacks'][attack_type]["damage"]
                    print(game['attacks'][attack_type]["message"])
                    if game['mummy_health'] <= 0:
                        print("You've defeated the mummy!")
                        input("Press Enter to continue...")
                        del game['rooms'][game['currentRoom']]["item"]
                        game['inventory'].append("ankh")
                        clear_screen()
                        ankh()
                        print("You found the Ankh among the mummy's remains!")
                        input("Press Enter to continue...")
                        game['in_combat'] = False  # exit combat mode
                    else:
                        print(f"The mummy has {game['mummy_health']} health left!")
                        input("Press Enter to continue...")
                else:
                    print(f"{attack_type.capitalize()} is not a valid attack!")
                    input("Press Enter to continue...")
            else:
                print("There is nothing to attack here!")
                input("Press Enter to continue...")

        # handle running away
        elif move[0] == "run":
            clear_screen()
            if game['in_combat']:
                print("You've managed to escape the mummy! You run back to the Antechamber.")
                game['currentRoom'] = "Antechamber"
                game['in_combat'] = False  # exit combat mode
                input("Press Enter to continue...")
            else:
                print("There's nothing to run from here.")
                input("Press Enter to continue...")
            continue
        else:
            print("Invalid command!")
            input("Press Enter to continue...")

        ## define how a player can win
        if game['currentRoom'] == "Entrance Hall" and "ankh" in game['inventory'] and "canopic jar" in game[
            'inventory']:
            pharaoh()
            print("You've escaped the Cursed Tomb with the sacred Ankh and mystical Canopic Jar... YOU WIN!")
            input("Press Enter to exit...")
            clear_screen()
            break


if __name__ == "__main__":
    main()

